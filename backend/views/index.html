<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Judge0 Code Runner with Monaco Editor</title>
    <!-- Load htmx -->
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
    <!-- Load Monaco Editor via CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.33.0/min/vs/loader.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      #editor {
        width: 100%;
        height: 300px;
        border: 1px solid #ccc;
      }
      #result {
        margin-top: 20px;
        border: 1px solid #ccc;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <h1>Run Code using Judge0 API with Monaco Editor</h1>
    <!-- The form will include a hidden input to capture the editor's content -->
    <form id="codeForm" hx-post="/run" hx-target="#result" hx-swap="innerHTML">
      <!-- Monaco Editor container -->
      <div id="editor"></div>
      <!-- Hidden input to hold the code -->
      <input type="hidden" name="code" id="codeInput" />
      <br />
      <label for="language">Select language:</label>
      <select name="language" id="language">
        <!-- Language IDs: 71 for Python 3, 54 for C++ (GCC 9.2.0), etc. -->
        <option value="71">Python 3</option>
        <option value="54">C++ (GCC 9.2.0)</option>
        <!-- Add more options as needed -->
      </select>
      <br /><br />
      <button type="submit" onclick="submitCode()">Run Code</button>
    </form>

    <div id="result"></div>

    <script>
      // Configure and initialize Monaco Editor
      require.config({
        paths: {
          vs: "https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.33.0/min/vs",
        },
      });
      var editor;
      require(["vs/editor/editor.main"], function () {
        editor = monaco.editor.create(document.getElementById("editor"), {
          value: "",
          language: "python",
          theme: "vs-dark",
        });
      });

      // Function to copy the editor's content to the hidden input field before form submission
      function submitCode() {
        document.getElementById("codeInput").value = editor.getValue();
      }
    </script>
  </body>
</html>
